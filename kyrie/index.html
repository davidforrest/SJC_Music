<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <link href="../styles.css" rel="stylesheet" type="text/css" />
  <title>Kyrie - Machaut</title>
</head>
<body>
  <div>
    <h2>Kyrie - Machaut</h2>

    <br>

    <br>Kyrie - Machaut (Oxford Camerata) <br>
    <audio id="audioControl1" controls>
      <source src="kyrie_machaut_oxford-camerata_Y47JdUI_PhE.mp3" type="audio/mpeg" />
    </audio>

    <br>

    <br>Kyrie - Machaut (Diabolus In Musica) <br>
    <audio id="audioControl2" controls>
      <source src="kyrie_machaut_diabolus_lOVsY1rxJB8.mp3" type="audio/mpeg" />
    </audio>

    <br>

    <br>Kyrie Cunctipotens Genitor - Chant (Ensemble Organum) <br>
    <audio id="audioControl3" controls>
      <source src="kyrie_chant_ensemble-organum_BphlyIVXyWQ.mp3" type="audio/mpeg" />
    </audio>

    <br>
    <br>
    <br>

    <button onclick="playRandomAudio()">Eternal Shuffle</button>

  </div>
  <script>
    // Get all the audio elements with id starting with "audioControl"
    var audioControls = Array.from(document.querySelectorAll("[id^='audioControl']"));

    // Set initial values for variables to keep track of the current audio and its control
    var currentAudioIndex = -1;
    var currentAudioControl = null;

    // Keep track of the number of times the current audio has played in a row
    var numPlays = 0;

    // Define a function to play a random audio control
    function playRandomAudio() {
      // Remove the previous "ended" event listener to prevent accumulation
      if (currentAudioControl !== null) {
        currentAudioControl.removeEventListener("ended", playRandomAudio);
      }

      // Generate a random index to choose a random audio control from the array
      var randomIndex = Math.floor(Math.random() * audioControls.length);

      // Rest of your playRandomAudio() function code

      var audioControl = audioControls[randomIndex];
      numPlays = 1;

      // Pause and restart the current audio and update the current audio control variable
      if (currentAudioControl !== null) {
        currentAudioControl.pause();
        currentAudioControl.currentTime = 0;
      }

      // Play the new audio and update the current audio and its control variables
      audioControl.play();
      currentAudioControl = audioControl;
      currentAudioIndex = randomIndex;

      // Add an event listener to play the next audio when the current audio finishes
      audioControl.addEventListener("ended", playRandomAudio);
    }
  </script>
</body>
</html>
