<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <link href="../styles.css" rel="stylesheet" type="text/css" />
  <title>Viderunt Omnes Aeterna</title>
</head>
<body>
  <div>
    <h2>Viderunt Omnes Aeterna</h2>

    <br>

    <br> Viderunt Omnes (Benedictines of St. Martin Beuron) <br>
    <audio id="audioControl1" controls>
      <source src="../musical_works/recordings/viderunt_chant_benedictines_st_martin_beuron_EN73kO2_PZA.mp3" type="audio/mpeg" />
    </audio>

    <br>

    <br> Viderunt Omnes (Tonus Peregrinus) <br>
    <audio id="audioControl2" controls>
      <source src="../musical_works/recordings/viderunt_chant_tonus_peregrinus_Ioz6gtDxfmU.mp3" type="audio/mpeg" />
    </audio>

    <br>

    <br> Viderunt Omnes (Amarcord) <br>
    <audio id="audioControl3" controls>
      <source src="../musical_works/recordings/viderunt_chant_amarcord_TEQw2BufNj8.mp3" type="audio/mpeg" />
    </audio>

    <br>
    <br>
    <br>

    <button onclick="playRandomAudio()">Play Eternally</button>

  </div>
  <script>
    // Get all the audio elements with id starting with "audioControl"
    var audioControls = Array.from(document.querySelectorAll("[id^='audioControl']"));

    // Set initial values for variables to keep track of the current audio and its control
    var currentAudioIndex = -1;
    var currentAudioControl = null;

    // Keep track of the number of times the current audio has played in a row
    var numPlays = 0;

    // Define a function to play a random audio control
    function playRandomAudio() {
      // Remove the previous "ended" event listener to prevent accumulation
      if (currentAudioControl !== null) {
        currentAudioControl.removeEventListener("ended", playRandomAudio);
      }

      // Generate a random index to choose a random audio control from the array
      var randomIndex = Math.floor(Math.random() * audioControls.length);

      // Rest of your playRandomAudio() function code

      var audioControl = audioControls[randomIndex];
      numPlays = 1;

      // Pause and restart the current audio and update the current audio control variable
      if (currentAudioControl !== null) {
        currentAudioControl.pause();
        currentAudioControl.currentTime = 0;
      }

      // Play the new audio and update the current audio and its control variables
      audioControl.play();
      currentAudioControl = audioControl;
      currentAudioIndex = randomIndex;

      // Add an event listener to play the next audio when the current audio finishes
      audioControl.addEventListener("ended", playRandomAudio);
    }
  </script>
</body>
</html>
