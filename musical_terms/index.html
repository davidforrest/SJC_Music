<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <style>
    .node-title {
      position: absolute;
      font-size: 18px; /* Default font size */
    }

    .large-node {
      font-size: 28px; /* Larger font size for nodes with value 2 */
    }
  </style>
  <canvas width="960" height="700"></canvas>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script>

    var canvas = document.querySelector("canvas"),
        context = canvas.getContext("2d"),
        width = canvas.width,
        height = canvas.height;

    var simulation = d3.forceSimulation()
        .force("link", d3.forceLink().id(function(d) { return d.id; }))
        .force("charge", d3.forceManyBody())
        .force("center", d3.forceCenter(width / 2, height / 2));

    d3.json("terms.json", function(error, graph) {
      if (error) throw error;

      simulation
          .nodes(graph.nodes)
          .on("tick", ticked);

      simulation.force("link")
          .links(graph.links);

      // Create a map to store node titles
      var nodeTitles = {};
      graph.nodes.forEach(function(node) {
        nodeTitles[node.id] = node.id; // You can change this to the actual title
      });

      // Create a div to display node titles
      var nodeTitleDiv = d3.select("body").append("div")
        .attr("id", "node-titles")
        .style("position", "absolute")
        .style("top", "0")
        .style("left", "0");

      // Function to update node titles
      function updateNodeTitles() {
        var titles = nodeTitleDiv.selectAll(".node-title")
          .data(graph.nodes);

        titles.enter().append("div")
          .attr("class", function(d) {
            return "node-title" + (d.value === 2 ? " large-node" : "");
          })
          .text(function(d) { return nodeTitles[d.id]; })
          .call(d3.drag()
            .on("start", dragstarted)
            .on("drag", dragged)
            .on("end", dragended));

        titles.exit().remove();

        titles.style("left", function(d) { return d.x + "px"; })
          .style("top", function(d) { return d.y + "px"; });
      }

      function ticked() {
      context.clearRect(0, 0, width, height);

      context.beginPath();
      graph.links.forEach(drawLink);
      context.strokeStyle = "#aaa";
      context.stroke();

      // Update node positions to stay within the canvas bounds
      graph.nodes.forEach(function(d) {
        d.x = Math.max(3, Math.min(width - 3, d.x)); // Limit x within canvas
        d.y = Math.max(3, Math.min(height - 3, d.y)); // Limit y within canvas
      });

      context.beginPath();
      graph.nodes.forEach(drawNode);
      context.fill();
      context.strokeStyle = "#fff";
      context.stroke();

      // Update node titles on each tick
      updateNodeTitles();
    }

      function dragstarted(d) {
        if (!d3.event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
      }

      function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
      }

      function dragended(d) {
        if (!d3.event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
      }

      function drawLink(d) {
        context.moveTo(d.source.x, d.source.y);
        context.lineTo(d.target.x, d.target.y);
      }

      function drawNode(d) {
        context.moveTo(d.x + 3, d.y);
        context.arc(d.x, d.y, 3, 0, 2 * Math.PI);
      }
    });

  </script>
</head>
<body>
  <canvas width=100%></canvas>
  <br>
  <div style="text-align: center;">
    <img src="1.jpg" style="width: 75%;">
    <br><br>
    <img src="2.jpg" style="width: 75%;">
    <br><br>
    <img src="3.jpg" style="width: 75%;">
  </div>
</body>
